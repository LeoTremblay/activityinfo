
buildscript {
    repositories {
        mavenCentral()

    }
    dependencies {
        classpath 'de.obqo.gradle:gradle-lesscss-plugin:1.0-1.3.3'
        classpath 'com.google.appengine:gradle-appengine-plugin:1.9.17'
        classpath 'net.sourceforge.fmpp:fmpp:0.9.14'
    }

    ant.taskdef(name: 'fmpp', classname:'fmpp.tools.AntTask', classpath: buildscript.configurations.classpath.asPath)
}


apply plugin: 'lesscss'
apply plugin: 'war'
apply plugin: 'appengine'
apply plugin: 'java'

appengine {
    downloadSdk = true
    warDir = file('src/main/webapp')
    
    appcfg {
        oauth2 = true
    }
}

lesscss {
    source = fileTree('src/main/less') {
        include 'styles.less'
    }
    
    dest = 'build/less'
    compress = true
}

war {
   // dependsOn 'lesscss'
//
//    from('build/less') {
//        into 'assets/css'
//    }
}

task generateStatic() << {
    ant.fmpp(
            configuration: "src/main/fmpp/config.fmpp",
            sourceRoot:    "src/main/templates",
            include:       "**/index.ftl",
            outputRoot:    "$buildDir/static"
    )
}


dependencies {
    appengineSdk 'com.google.appengine:appengine-java-sdk:1.9.17'
}
